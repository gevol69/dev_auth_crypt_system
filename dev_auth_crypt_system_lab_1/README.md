### Лабораторная работа №1

#### Реализация алгоритма RSA
**RSA** (аббревиатура от фамилий Rivest, Shamir и Adleman) — криптографический алгоритм с открытым ключом, основывающийся на вычислительной сложности задачи факторизации больших целых чисел.  
Алгоритм RSA является алгоритмом ассиметричного шифрования.  
В криптографической системе с открытым ключом каждый участник располагает как **открытым ключом (public key)**, так и **закрытым ключом (англ. private key)**.  
В криптографической системе RSA каждый ключ состоит из пары целых чисел. Каждый участник создаёт свой открытый и закрытый ключ самостоятельно. Закрытый ключ каждый из них держит в секрете, а открытые ключи можно сообщать кому угодно или даже публиковать их. Открытый и закрытый ключи каждого участника обмена сообщениями в криптосистеме RSA образуют «согласованную пару» в том смысле, что они являются *взаимно обратными*.  

#### Алгоритм создания открытого и закрытого ключа
1. Выбираются 2 различных случайных простых числа *p* и *q*.  
2. Вычисляется их произведение ***n* = *p* * *q***, которое называется ***модулем***.
3. Вычисляется значение функции Эйлера от числа ***n***:
    ***φ(n) = (p - 1) * (q - 1)***
4. Выбирается целое число ***e*** (для ключа шифрования) взаимно простое со значением функции ***φ(n)*** (то есть наибольший общий делитель ***e*** и ***φ(n)*** должен быть равен 1)
5. Вычисляется число ***d*** (для ключа дешифрования), которое является мультипликативной обратной величиной ***e***:
    ***d ≡ e^(− 1) (mod φ(n))`***
6. ***(e, n)*** - открытый ключ RSA; ***(d, n)*** - закрытый ключ RSA.  

Предположим, что Боб хочет послать открытый текст ***m*** Алисе. Чтобы зашифровать открытый текст, Боб должен знать открытый ключ Алисы ***(e, n)*** , а Алиса должна использовать свой закрытый ключ ***(d, n)*** для расшифровки информации. Алиса должна передать свой открытый ключ ***(e, n)*** Бобу. Зашифрованное сообщение Боба может быть расшифровано только с помощью закрытого ключа Алисы ***(d, n)***

#### Алгоритм шифрования
1. Взять открытый ключ Алисы ***(e, n)***
2. Взять открытый текст ***m***
3. Преобразовать каждый символ сообщения в его эквивалент ASCII и получить целое число.
3. Зашифровать получишееся число с использованием открытого ключа Алисы:
    ***crypt_message = m^e mod n`***

#### Алгоритм дешифрования
1. Принять зашифрованное сообщение ***crypt_message***
2. Взять свой закрытый ключ ***(d, n)***
3. Применить закрытый ключ для расшифрования числа:
    ***m = crypt_message^d mod n`***
4. Преобразовать число в текст с помощью ASCII.

#### Использование программы
Для тестирования скрипта необходимо проделать следующие действия:
1. Создайте 2 директории: Alice и Bob
2. Запустите exe файл **rsa.exe**.
3. В графическом интерфейсе нажмите кнопку **Сгенерировать ключи в директорию** и сгенерируйте ключи в папках Alice и Bob.
4. Посмотреть последние сгенерированные ключи Вы можете с помощью кнопок **Посмотреть открытый ключ** и **Посмотреть закрытый ключ**.
5. Введите сообщение, которое хотите зашифровать в поле **Сообщение**.
6. Нажмите кнопку **Зашифровать** и выберете открытый ключ того, кому хотите послать сообщение (в случае если от Боба Алисе, то выберите открытый ключ Алисы).
7. Нажмите кнопку **Расшифровать** и выберете закрытый ключ того, кому передавалось сообщение (в случае если от Боба Алисе, то выберите закрытый ключ Алисы).
8. Кнопкой **Рестарт** будут сброшены все настройки, очищены поля и можно будет приступить к генерации ключей заново.

#### Демонстрация работы программы
![Alt Text](http://ipic.su/img/img7/fs/2020-10-18-18-05-42.1603033848.gif)

#### Подпись exe файла с помощью PKI Client в Windows PowerShell

Подписать exe файл самозаверяющимся сертификатом можно следующим образом:

1. Создать самозаверяющийся сертификат командой:

```New-SelfSignedCertificate -Type Custom -Subject "CN=Vlad Gerasimov, O=Gevol Corporation, C=RU" -KeyUsage DigitalSignature -FriendlyName "Vlad Gerasimov" -CertStoreLocation "Cert:\CurrentUser\My" -TextExtension @("2.5.29.37={text}1.3.6.1.5.5.7.3.3", "2.5.29.19={text}")```

2. Задать переменной **cert** только что созданный сертификат:

```$cert=Get-ChildItem -Path cert:\CurrentUser\my -CodeSigningCert```

3. Подписать exe файл этим сертификатом командой:

```Set-AuthenticodeSignature rsa.exe $cert -HashAlgorithm RSA```

4. Файл подписан:

![](https://image.prntscr.com/image/VA-6-ZqqRImlQggDTM6Tpg.png)